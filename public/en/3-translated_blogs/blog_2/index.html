<!DOCTYPE html>
<html lang="en" dir="ltr" itemscope itemtype="http://schema.org/Article" data-r-output-format="html">
  <head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="utf-8">
    <meta name="viewport" content="height=device-height, width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <meta name="generator" content="Hugo 0.149.1">
    <meta name="generator" content="Relearn 8.0.0+9803d5122ebb3276acea823f476e9eb44f607862">
    <meta name="description" content="Äá»‹nh tuyáº¿n Ä‘á»™ng sá»­ dá»¥ng MÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n AWS VPC Ammar Latif vÃ  Akshay Choudhry - 02/09/2025
Amazon VPC Route Server cho phÃ©p triá»ƒn khai cÆ¡ cháº¿ Ä‘á»‹nh tuyáº¿n Ä‘á»™ng trong Amazon VPC báº±ng cÃ¡ch sá»­ dá»¥ng giao thá»©c BGP (Border Gateway Protocol). Vá»›i dá»‹ch vá»¥ nÃ y, báº¡n cÃ³ thá»ƒ kiá»ƒm soÃ¡t lÆ°u lÆ°á»£ng giá»¯a cÃ¡c á»©ng dá»¥ng trÃªn cloud vÃ  há»‡ thá»‘ng on-premises má»™t cÃ¡ch thÃ´ng minh vÃ  hiá»‡u quáº£ hÆ¡n. BGP giÃºp báº¡n quáº£n lÃ½ Ä‘Æ°á»ng Ä‘i cá»§a dá»¯ liá»‡u linh hoáº¡t, Ä‘áº·c biá»‡t trong cÃ¡c tÃ¬nh huá»‘ng xáº£y ra sá»± cá»‘, Ä‘á»“ng thá»i giáº£m thiá»ƒu khá»‘i lÆ°á»£ng cÃ´ng viá»‡c thá»§ cÃ´ng vÃ  háº¡n cháº¿ rá»§i ro do con ngÆ°á»i.">
    <meta name="author" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="Blog 2 :: Internship Report">
    <meta name="twitter:description" content="Äá»‹nh tuyáº¿n Ä‘á»™ng sá»­ dá»¥ng MÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n AWS VPC Ammar Latif vÃ  Akshay Choudhry - 02/09/2025
Amazon VPC Route Server cho phÃ©p triá»ƒn khai cÆ¡ cháº¿ Ä‘á»‹nh tuyáº¿n Ä‘á»™ng trong Amazon VPC báº±ng cÃ¡ch sá»­ dá»¥ng giao thá»©c BGP (Border Gateway Protocol). Vá»›i dá»‹ch vá»¥ nÃ y, báº¡n cÃ³ thá»ƒ kiá»ƒm soÃ¡t lÆ°u lÆ°á»£ng giá»¯a cÃ¡c á»©ng dá»¥ng trÃªn cloud vÃ  há»‡ thá»‘ng on-premises má»™t cÃ¡ch thÃ´ng minh vÃ  hiá»‡u quáº£ hÆ¡n. BGP giÃºp báº¡n quáº£n lÃ½ Ä‘Æ°á»ng Ä‘i cá»§a dá»¯ liá»‡u linh hoáº¡t, Ä‘áº·c biá»‡t trong cÃ¡c tÃ¬nh huá»‘ng xáº£y ra sá»± cá»‘, Ä‘á»“ng thá»i giáº£m thiá»ƒu khá»‘i lÆ°á»£ng cÃ´ng viá»‡c thá»§ cÃ´ng vÃ  háº¡n cháº¿ rá»§i ro do con ngÆ°á»i.">
    <meta property="og:url" content="http://localhost:1313/en/3-translated_blogs/blog_2/index.html">
    <meta property="og:site_name" content="Internship Report">
    <meta property="og:title" content="Blog 2 :: Internship Report">
    <meta property="og:description" content="Äá»‹nh tuyáº¿n Ä‘á»™ng sá»­ dá»¥ng MÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n AWS VPC Ammar Latif vÃ  Akshay Choudhry - 02/09/2025
Amazon VPC Route Server cho phÃ©p triá»ƒn khai cÆ¡ cháº¿ Ä‘á»‹nh tuyáº¿n Ä‘á»™ng trong Amazon VPC báº±ng cÃ¡ch sá»­ dá»¥ng giao thá»©c BGP (Border Gateway Protocol). Vá»›i dá»‹ch vá»¥ nÃ y, báº¡n cÃ³ thá»ƒ kiá»ƒm soÃ¡t lÆ°u lÆ°á»£ng giá»¯a cÃ¡c á»©ng dá»¥ng trÃªn cloud vÃ  há»‡ thá»‘ng on-premises má»™t cÃ¡ch thÃ´ng minh vÃ  hiá»‡u quáº£ hÆ¡n. BGP giÃºp báº¡n quáº£n lÃ½ Ä‘Æ°á»ng Ä‘i cá»§a dá»¯ liá»‡u linh hoáº¡t, Ä‘áº·c biá»‡t trong cÃ¡c tÃ¬nh huá»‘ng xáº£y ra sá»± cá»‘, Ä‘á»“ng thá»i giáº£m thiá»ƒu khá»‘i lÆ°á»£ng cÃ´ng viá»‡c thá»§ cÃ´ng vÃ  háº¡n cháº¿ rá»§i ro do con ngÆ°á»i.">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="website">
    <meta itemprop="name" content="Blog 2 :: Internship Report">
    <meta itemprop="description" content="Äá»‹nh tuyáº¿n Ä‘á»™ng sá»­ dá»¥ng MÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n AWS VPC Ammar Latif vÃ  Akshay Choudhry - 02/09/2025
Amazon VPC Route Server cho phÃ©p triá»ƒn khai cÆ¡ cháº¿ Ä‘á»‹nh tuyáº¿n Ä‘á»™ng trong Amazon VPC báº±ng cÃ¡ch sá»­ dá»¥ng giao thá»©c BGP (Border Gateway Protocol). Vá»›i dá»‹ch vá»¥ nÃ y, báº¡n cÃ³ thá»ƒ kiá»ƒm soÃ¡t lÆ°u lÆ°á»£ng giá»¯a cÃ¡c á»©ng dá»¥ng trÃªn cloud vÃ  há»‡ thá»‘ng on-premises má»™t cÃ¡ch thÃ´ng minh vÃ  hiá»‡u quáº£ hÆ¡n. BGP giÃºp báº¡n quáº£n lÃ½ Ä‘Æ°á»ng Ä‘i cá»§a dá»¯ liá»‡u linh hoáº¡t, Ä‘áº·c biá»‡t trong cÃ¡c tÃ¬nh huá»‘ng xáº£y ra sá»± cá»‘, Ä‘á»“ng thá»i giáº£m thiá»ƒu khá»‘i lÆ°á»£ng cÃ´ng viá»‡c thá»§ cÃ´ng vÃ  háº¡n cháº¿ rá»§i ro do con ngÆ°á»i.">
    <meta itemprop="wordCount" content="3605">
    <title>Blog 2 :: Internship Report</title>
    <link href="/en/3-translated_blogs/blog_2/index.xml" rel="alternate" type="application/rss+xml" title="Blog 2 :: Internship Report">
    <link href="/css/auto-complete/auto-complete.min.css?1758804677" rel="stylesheet">
    <script src="/js/auto-complete/auto-complete.min.js?1758804677" defer></script>
    <script src="/js/search-lunr.js?1758804677" defer></script>
    <script src="/js/search.js?1758804677" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.index_js_url="/searchindex.en.js?1758804677";
    </script>
    <script src="/js/lunr/lunr.min.js?1758804677" defer></script>
    <script src="/js/lunr/lunr.stemmer.support.min.js?1758804677" defer></script>
    <script src="/js/lunr/lunr.multi.min.js?1758804677" defer></script>
    <script src="/js/lunr/lunr.en.min.js?1758804677" defer></script>
    <script>
      window.relearn = window.relearn || {};
      window.relearn.contentLangs=['en'];
    </script>
    <link href="/fonts/fontawesome/css/fontawesome-all.min.css?1758804677" rel="stylesheet" media="print" onload="this.media='all';this.onload=null;"><noscript><link href="/fonts/fontawesome/css/fontawesome-all.min.css?1758804677" rel="stylesheet"></noscript>
    <link href="/css/perfect-scrollbar/perfect-scrollbar.min.css?1758804677" rel="stylesheet">
    <link href="/css/theme.css?1758804677" rel="stylesheet">
    <link href="/css/format-html.css?1758804677" rel="stylesheet" id="R-format-style">
    <script>
      window.relearn = window.relearn || {};
      // configuration
      window.relearn.min = ``;
      window.relearn.path='\/3-translated_blogs\/blog_2\/index.html';
      window.relearn.relBasePath='..\/..\/..';
      window.relearn.relBaseUri='..\/..\/..';
      window.relearn.absBaseUri='http:\/\/localhost:1313';
      window.relearn.disableAnchorCopy=false;
      window.relearn.disableAnchorScrolling=false;
      window.relearn.disableInlineCopyToClipboard=false;
      window.relearn.enableBlockCodeWrap=true;
      // legal
      window.relearn.getItem = (s,n) => {return s.getItem(n)};
      window.relearn.setItem = (s,n,v) => {return s.setItem(n,v)};
      window.relearn.removeItem = (s,n) => {return s.removeItem(n)};
      // translations
      window.T_Copy_to_clipboard = `Copy to clipboard`;
      window.T_Copied_to_clipboard = `Copied to clipboard!`;
      window.T_Copy_link_to_clipboard = `Copy link to clipboard`;
      window.T_Link_copied_to_clipboard = `Copied link to clipboard!`;
      window.T_Reset_view = `Reset view`;
      window.T_View_reset = `View reset!`;
      window.T_No_results_found = `No results found for "{0}"`;
      window.T_N_results_found = `{1} results found for "{0}"`;
      // variant stuff
      window.relearn.themevariants = [ 'relearn-light', 'relearn-dark' ];
      window.relearn.customvariantname = "my-custom-variant";
      window.relearn.changeVariant = function(variant) {
        var oldVariant = document.documentElement.dataset.rThemeVariant;
        window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        document.documentElement.dataset.rThemeVariant = variant;
        if (oldVariant != variant) {
          document.dispatchEvent( new CustomEvent('themeVariantLoaded', { detail: { variant, oldVariant } }) );
          window.relearn.markVariant();
        }
      }
      window.relearn.markVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant");
        document.querySelectorAll(".R-variantswitcher select").forEach((select) => {select.value = variant;});
      }
      window.relearn.initVariant = function() {
        var variant = window.relearn.getItem(window.localStorage, window.relearn.absBaseUri + "/variant") ?? "";
        if( variant == window.relearn.customvariantname ){
        }else if( !variant || !window.relearn.themevariants.includes(variant) ){
          variant = window.relearn.themevariants[0];
          window.relearn.setItem(window.localStorage, window.relearn.absBaseUri + "/variant", variant);
        }
        document.documentElement.dataset.rThemeVariant = variant;
      }
      window.relearn.initVariant();
      window.relearn.markVariant();
    </script>
    <link href="/css/custom.css?1758804677" rel="stylesheet">
  </head>
  <body class="mobile-support html" data-url="/en/3-translated_blogs/blog_2/index.html">
    <div id="R-body" class="default-animation">
      <div id="R-body-overlay"></div>
      <nav id="R-topbar">
        <div class="topbar-wrapper">
          <div class="topbar-sidebar-divider"></div>
          <div class="topbar-area topbar-area-start" data-area="start">
            <div class="topbar-button topbar-button-sidebar" data-content-empty="disable" data-width-s="show" data-width-m="hide" data-width-l="hide"><button class="topbar-control" onclick="toggleNav()" type="button" title="Menu (CTRL&#43;ALT&#43;n)"><i class="fa-fw fas fa-bars"></i></button>
            </div>
            <div class="topbar-button topbar-button-toc" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="Table of Contents (CTRL&#43;ALT&#43;t)"><i class="fa-fw fas fa-list-alt"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
<nav class="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#yÃªu-cáº§u-kiáº¿n-thá»©c-ná»n-táº£ng">YÃªu cáº§u kiáº¿n thá»©c ná»n táº£ng</a></li>
        <li><a href="#cÃ¡c-tÃ¬nh-huá»‘ng-káº¿t-ná»‘i-á»©ng-dá»¥ng">CÃ¡c tÃ¬nh huá»‘ng káº¿t ná»‘i á»©ng dá»¥ng</a></li>
        <li><a href="#tÃ­nh-nÄƒng-cá»§a-vpc-route-server">TÃ­nh nÄƒng cá»§a VPC Route Server</a></li>
        <li><a href="#phÃ¡t-hiá»‡n-vÃ -khÃ´i-phá»¥c-khi-xáº£y-ra-failover">PhÃ¡t hiá»‡n vÃ  khÃ´i phá»¥c khi xáº£y ra Failover</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
              </div>
            </div>
          </div>
          <ol class="topbar-breadcrumbs breadcrumbs highlightable" itemscope itemtype="http://schema.org/BreadcrumbList"><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/en/index.html"><span itemprop="name">Internship Report</span></a><meta itemprop="position" content="1">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><a itemprop="item" href="/en/3-translated_blogs/index.html"><span itemprop="name">Translated Blogs</span></a><meta itemprop="position" content="2">&nbsp;>&nbsp;</li><li itemscope itemtype="https://schema.org/ListItem" itemprop="itemListElement" class=""><span itemprop="name">Blog 2</span><meta itemprop="position" content="3"></li>
          </ol>
          <div class="topbar-area topbar-area-end" data-area="end">
            <div class="topbar-button topbar-button-prev" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/en/3-translated_blogs/blog_1/index.html" title="Blog 1 (ğŸ¡)"><i class="fa-fw fas fa-chevron-left"></i></a>
            </div>
            <div class="topbar-button topbar-button-next" data-content-empty="disable" data-width-s="show" data-width-m="show" data-width-l="show"><a class="topbar-control" href="/en/3-translated_blogs/blog_3/index.html" title="Blog 3 (ğŸ¡’)"><i class="fa-fw fas fa-chevron-right"></i></a>
            </div>
            <div class="topbar-button topbar-button-more" data-content-empty="hide" data-width-s="show" data-width-m="show" data-width-l="show"><button class="topbar-control" onclick="toggleTopbarFlyout(this)" type="button" title="More"><i class="fa-fw fas fa-ellipsis-v"></i></button>
              <div class="topbar-content">
                <div class="topbar-content-wrapper">
                  <div class="topbar-area topbar-area-more" data-area="more">
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <div id="R-main-overlay"></div>
      <main id="R-body-inner" class="highlightable 3-translated_blogs" tabindex="-1">
        <div class="flex-block-wrapper">
<article class="default">
  <header class="headline">
  </header>

<h1 id="blog-2">Blog 2</h1>

<h1 id="Ä‘á»‹nh-tuyáº¿n-Ä‘á»™ng-sá»­-dá»¥ng-mÃ¡y-chá»§-Ä‘á»‹nh-tuyáº¿n-aws-vpc">Äá»‹nh tuyáº¿n Ä‘á»™ng sá»­ dá»¥ng MÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n AWS VPC</h1>
<p><em>Ammar Latif vÃ  Akshay Choudhry - 02/09/2025</em></p>
<hr>
<p><a href="https://docs.aws.amazon.com/vpc/latest/userguide/dynamic-routing-route-server.html" rel="external" target="_blank">Amazon VPC Route Server</a> cho phÃ©p triá»ƒn khai cÆ¡ cháº¿ Ä‘á»‹nh tuyáº¿n Ä‘á»™ng trong <a href="https://aws.amazon.com/vpc/" rel="external" target="_blank">Amazon VPC</a> báº±ng cÃ¡ch sá»­ dá»¥ng giao thá»©c BGP (Border Gateway Protocol). Vá»›i dá»‹ch vá»¥ nÃ y, báº¡n cÃ³ thá»ƒ kiá»ƒm soÃ¡t lÆ°u lÆ°á»£ng giá»¯a cÃ¡c á»©ng dá»¥ng trÃªn cloud vÃ  há»‡ thá»‘ng on-premises má»™t cÃ¡ch thÃ´ng minh vÃ  hiá»‡u quáº£ hÆ¡n. BGP giÃºp báº¡n quáº£n lÃ½ Ä‘Æ°á»ng Ä‘i cá»§a dá»¯ liá»‡u linh hoáº¡t, Ä‘áº·c biá»‡t trong cÃ¡c tÃ¬nh huá»‘ng xáº£y ra sá»± cá»‘, Ä‘á»“ng thá»i giáº£m thiá»ƒu khá»‘i lÆ°á»£ng cÃ´ng viá»‡c thá»§ cÃ´ng vÃ  háº¡n cháº¿ rá»§i ro do con ngÆ°á»i.</p>
<p>Trong bÃ i viáº¿t nÃ y, chÃºng ta sáº½ xem xÃ©t nhiá»u tÃ¬nh huá»‘ng á»©ng dá»¥ng trong Ä‘Ã³ viá»‡c Ä‘á»‹nh tuyáº¿n Ä‘á»™ng á»Ÿ má»©c á»©ng dá»¥ng cÃ³ áº£nh hÆ°á»Ÿng trá»±c tiáº¿p Ä‘áº¿n cÃ¡ch dá»¯ liá»‡u Ä‘Æ°á»£c truyá»n Ä‘áº¿n cÃ¡c instance, cÅ©ng nhÆ° cÃ¡ch há»‡ thá»‘ng xá»­ lÃ½ khi cÃ³ sá»± cá»‘ Ä‘á»ƒ giáº£m giÃ¡n Ä‘oáº¡n xuá»‘ng má»©c tháº¥p nháº¥t.</p>
<h3 id="yÃªu-cáº§u-kiáº¿n-thá»©c-ná»n-táº£ng">YÃªu cáº§u kiáº¿n thá»©c ná»n táº£ng</h3>
<p>NgÆ°á»i Ä‘á»c Ä‘Æ°á»£c giáº£ Ä‘á»‹nh lÃ  Ä‘Ã£ náº¯m cÃ¡c khÃ¡i niá»‡m máº¡ng cÆ¡ báº£n trong AWS liÃªn quan Ä‘áº¿n tÃ­nh sáºµn sÃ ng cao vÃ  cÆ¡ cháº¿ failover, cháº³ng háº¡n nhÆ° <a href="https://aws.amazon.com/ec2/" rel="external" target="_blank">Amazon Elastic Compute Cloud (Amazon EC2)</a>, <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html" rel="external" target="_blank">Elastic Network Interfaces (ENI)</a>, Amazon VPC, báº£ng Ä‘á»‹nh tuyáº¿n VPC, vÃ  <a href="https://aws.amazon.com/about-aws/global-infrastructure/regions_az/" rel="external" target="_blank">Availability Zone (AZ)</a>. NgoÃ i ra, báº¡n cÅ©ng nÃªn hiá»ƒu vá» cÃ¡c nguyÃªn lÃ½ máº¡ng phá»• biáº¿n nhÆ° Ä‘á»‹a chá»‰ IP, CIDR, Ä‘á»‹nh tuyáº¿n máº¡ng, BGP vÃ  Bidirectional Forwarding Detection (BFD). BÃ i viáº¿t nÃ y sáº½ khÃ´ng Ä‘i sÃ¢u vÃ o viá»‡c giáº£i thÃ­ch cÃ¡c khÃ¡i niá»‡m ná»n táº£ng Ä‘Ã³, mÃ  táº­p trung mÃ´ táº£ cÃ¡ch sá»­ dá»¥ng chÃºng Ä‘á»ƒ triá»ƒn khai giáº£i phÃ¡p floating IP cho viá»‡c chuyá»ƒn Ä‘á»•i dá»± phÃ²ng á»©ng dá»¥ng. Náº¿u báº¡n cáº§n tÃ¬m hiá»ƒu thÃªm vá» ná»n táº£ng máº¡ng AWS, hÃ£y tham kháº£o tÃ i liá»‡u chÃ­nh thá»©c cá»§a AWS vá» VPC networking vÃ  cÃ¡c bÃ i viáº¿t trong má»¥c AWS Networking and Content Delivery <a href="https://docs.aws.amazon.com/vpc/latest/userguide/dynamic-routing-route-server.html" rel="external" target="_blank">á» Ä‘Ã¢y</a>.</p>
<h3 id="cÃ¡c-tÃ¬nh-huá»‘ng-káº¿t-ná»‘i-á»©ng-dá»¥ng">CÃ¡c tÃ¬nh huá»‘ng káº¿t ná»‘i á»©ng dá»¥ng</h3>
<p>Trong VPC, route table lÃ  thÃ nh pháº§n quyáº¿t Ä‘á»‹nh luá»“ng dá»¯ liá»‡u Ä‘i nhÆ° tháº¿ nÃ o. ChÃºng Ä‘Æ°á»£c gÃ¡n cho subnet, Internet Gateway (IGW), hoáº·c Virtual Private Gateway Ä‘á»ƒ Ä‘á»‹nh nghÄ©a Ä‘Æ°á»ng Ä‘i cá»§a lÆ°u lÆ°á»£ng trÆ°á»›c khi Ä‘áº¿n Ä‘Ã­ch. VÃ­ dá»¥, báº¡n cÃ³ thá»ƒ thÃªm route Ä‘á»ƒ táº¥t cáº£ traffic Ä‘i qua má»™t firewall trÆ°á»›c khi Ä‘áº¿n á»©ng dá»¥ng, hoáº·c buá»™c subnet pháº£i Ä‘i qua NAT Gateway, IGW, Peering Connection, hoáº·c VPN Gateway tÃ¹y nhu cáº§u.</p>
<p>Má»™t sá»‘ á»©ng dá»¥ng Ä‘áº·c biá»‡t (nhÆ° thiáº¿t bá»‹ an ninh máº¡ng hoáº·c xá»­ lÃ½ traffic) yÃªu cáº§u kháº£ nÄƒng kiá»ƒm soÃ¡t chi tiáº¿t Ä‘Æ°á»ng Ä‘i cá»§a dá»¯ liá»‡u Ä‘á»ƒ Ä‘áº£m báº£o táº¥t cáº£ lÆ°u lÆ°á»£ng pháº£i Ä‘Æ°á»£c gá»­i Ä‘áº¿n á»©ng dá»¥ng trung gian nÃ y trÆ°á»›c khi Ä‘áº¿n Ä‘iá»ƒm Ä‘Ã­ch cuá»‘i cÃ¹ng. Má»™t vÃ­ dá»¥ quen thuá»™c lÃ  viá»‡c Ä‘iá»u hÆ°á»›ng traffic Ä‘áº¿n thiáº¿t bá»‹ báº£o máº­t Ä‘á»ƒ kiá»ƒm tra trÆ°á»›c khi gá»­i sang dá»‹ch vá»¥ chÃ­nh.</p>
<p>Náº¿u chá»‰ dÃ¹ng static route thÃ¬ báº¡n cÃ³ thá»ƒ lÃ m Ä‘Æ°á»£c Ä‘iá»u Ä‘Ã³, nhÆ°ng nÃ³ tá»“n táº¡i nhiá»u háº¡n cháº¿:</p>
<ul>
<li>KhÃ´ng tá»± Ä‘á»™ng thÃ­ch á»©ng khi cÃ³ sá»± cá»‘.</li>
<li>Cáº§n thao tÃ¡c thá»§ cÃ´ng Ä‘á»ƒ thay Ä‘á»•i.</li>
<li>Quáº£n lÃ½ trá»Ÿ nÃªn phá»©c táº¡p khi há»‡ thá»‘ng má»Ÿ rá»™ng.
Há»‡ quáº£ lÃ  tÄƒng nguy cÆ¡ lá»—i con ngÆ°á»i vÃ  kÃ©o dÃ i thá»i gian phá»¥c há»“i. Trong khi Ä‘Ã³, dynamic routing cÃ³ thá»ƒ giáº£i quyáº¿t: tá»± Ä‘á»™ng cáº­p nháº­t route table, Ä‘áº£m báº£o kháº£ nÄƒng má»Ÿ rá»™ng, vÃ  há»— trá»£ failover mÃ  khÃ´ng cáº§n thao tÃ¡c thá»§ cÃ´ng.</li>
</ul>
<p>LÆ°u Ã½: AWS khuyáº¿n nghá»‹ sá»­ dá»¥ng Gateway Load Balancer (GWLB) cho nhu cáº§u HA vÃ  redundancy. Chá»‰ khi nÃ o á»©ng dá»¥ng khÃ´ng há»— trá»£ GWLB (hoáº·c mÃ´i trÆ°á»ng khÃ´ng cÃ³ GWLB, vÃ­ dá»¥ AWS Local Zone), báº¡n má»›i nÃªn cÃ¢n nháº¯c giáº£i phÃ¡p vá»›i Route Server.</p>
<h3 id="tÃ­nh-nÄƒng-cá»§a-vpc-route-server">TÃ­nh nÄƒng cá»§a VPC Route Server</h3>
<p>VPC Route Server cung cáº¥p Ä‘á»‹nh tuyáº¿n Ä‘á»™ng bÃªn trong VPC thÃ´ng qua BGP. CÃ¡c á»©ng dá»¥ng máº¡ng cÃ³ thá»ƒ dÃ¹ng BGP Ä‘á»ƒ cáº­p nháº­t báº£ng Ä‘á»‹nh tuyáº¿n cá»§a VPC, tá»« Ä‘Ã³ kiá»ƒm soÃ¡t lÆ°u lÆ°á»£ng chi tiáº¿t vÃ  há»— trá»£ failover tá»± Ä‘á»™ng giá»¯a cÃ¡c instance trong cÃ¹ng hoáº·c khÃ¡c AZ. Route Server cÅ©ng cÃ³ thá»ƒ cáº­p nháº­t báº£ng Ä‘á»‹nh tuyáº¿n cá»§a VPC vÃ  IGW vá»›i cÃ¡c Ä‘Æ°á»ng Ä‘i IPv4/IPv6 Æ°u tiÃªn, giÃºp workload cÃ³ kháº£ nÄƒng chá»‹u lá»—i cao. Khi má»™t AZ gáº·p sá»± cá»‘, Route Server sáº½ tá»± Ä‘á»™ng cáº­p nháº­t route table Ä‘á»ƒ chuyá»ƒn hÆ°á»›ng traffic sang AZ khÃ¡c, cáº£i thiá»‡n kháº£ nÄƒng quáº£n lÃ½ vÃ  tÃ­nh tÆ°Æ¡ng thÃ­ch vá»›i á»©ng dá»¥ng cá»§a bÃªn thá»© ba.
ChÃºng ta sáº½ xem xÃ©t cÃ¡c tÃ¬nh huá»‘ng dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ tháº¥y Ä‘Æ°á»£c cÃ¡c kháº£ nÄƒng Ä‘á»‹nh tuyáº¿n cá»§a VPC Route Server.</p>
<p><strong>TÃ¬nh huá»‘ng #1: DÃ¹ng Floating IP cho application failover (chuyá»ƒn Ä‘á»•i dá»± phÃ²ng á»©ng dá»¥ng)</strong>
Giáº£ sá»­ báº¡n cÃ³ á»©ng dá»¥ng quan trá»ng cháº¡y trÃªn má»™t EC2 á»Ÿ AZ1. Äá»ƒ Ä‘áº£m báº£o tÃ­nh sáºµn sÃ ng, báº¡n triá»ƒn khai thÃªm má»™t instance standby á»Ÿ AZ2. á»¨ng dá»¥ng nÃ y khÃ´ng tÃ­ch há»£p vá»›i GWLB hoáº·c mÃ´i trÆ°á»ng khÃ´ng há»— trá»£ GWLB. Má»¥c tiÃªu cá»§a báº¡n lÃ  duy trÃ¬ á»©ng dá»¥ng hoáº¡t Ä‘á»™ng liÃªn tá»¥c khi instance chÃ­nh hoáº·c cáº£ AZ1 bá»‹ lá»—i.</p>
<p>Trong ká»‹ch báº£n nÃ y, chÃºng ta minh há»a cÃ¡ch sá»­ dá»¥ng floating IP Ä‘á»ƒ thá»±c hiá»‡n quÃ¡ trÃ¬nh failover liá»n máº¡ch giá»¯a hai EC2 instance Ä‘Æ°á»£c triá»ƒn khai á»Ÿ hai AZ khÃ¡c nhau trong má»™t kiáº¿n trÃºc high availability. Báº¡n cÃ³ má»™t á»©ng dá»¥ng quan trá»ng cháº¡y trÃªn EC2 á»Ÿ AZ1, Ä‘á»“ng thá»i má»™t EC2 khÃ¡c Ä‘Æ°á»£c triá»ƒn khai á»Ÿ AZ2 Ä‘á»ƒ lÃ m mÃ¡y dá»± phÃ²ng. á»¨ng dá»¥ng nÃ y khÃ´ng Ä‘Æ°á»£c tÃ­ch há»£p vá»›i Gateway Load Balancer (GWLB), hoáº·c mÃ´i trÆ°á»ng AWS cá»§a báº¡n (vÃ­ dá»¥ Local Zone) khÃ´ng há»— trá»£ GWLB. Má»¥c tiÃªu Ä‘áº·t ra lÃ  Ä‘áº£m báº£o cÆ¡ cháº¿ dá»± phÃ²ng cho á»©ng dá»¥ng trong trÆ°á»ng há»£p instance chÃ­nh hoáº·c cáº£ AZ1 gáº·p sá»± cá»‘.</p>
<p>Báº¡n cÃ³ thá»ƒ dÃ¹ng AWS CloudFormation tá»« repo aws-samples Ä‘á»ƒ triá»ƒn khai ká»‹ch báº£n #1 vÃ o tÃ i khoáº£n AWS cá»§a mÃ¬nh. Template CloudFormation sáº½ tá»± Ä‘á»™ng táº¡o ra mÃ´i trÆ°á»ng sau:</p>
<ul>
<li>Má»™t VPC vá»›i 3 subnet náº±m trÃªn 2 AZ.</li>
<li>Báº£ng Ä‘á»‹nh tuyáº¿n (route table) cho cáº£ 3 subnet.</li>
<li>Táº¡o vÃ  gáº¯n Internet Gateway (IGW) vÃ o VPC, Ä‘á»“ng thá»i thÃªm route máº·c Ä‘á»‹nh ra IGW trong route table.</li>
<li>Táº¡o vÃ  gáº¯n Route Server cho VPC (Route Server sá»­ dá»¥ng ASN 65000).</li>
<li>Táº¡o hai Route Server Endpoint (RSE) trong má»—i subnet Ä‘á»ƒ Ä‘áº£m báº£o tÃ­nh sáºµn sÃ ng cao.</li>
<li>Thiáº¿t láº­p cÃ¡c route server peer.</li>
<li>Táº¡o hai EC2 instance Ä‘á»ƒ mÃ´ phá»ng á»©ng dá»¥ng HA cáº§n kiá»ƒm thá»­, sá»­ dá»¥ng pháº§n má»m Gobgp.</li>
<li>Má»—i instance sáº½ cháº¡y BGP vá»›i ASN 65001 vÃ  káº¿t ná»‘i BGP tá»›i RSE trong subnet tÆ°Æ¡ng á»©ng.</li>
<li>File cáº¥u hÃ¬nh Gobgp (gobgpd.conf) Ä‘Æ°á»£c náº¡p sáºµn thÃ´ng qua user-data khi táº¡o EC2, vÃ  Ä‘Æ°á»£c lÆ°u táº¡i thÆ° má»¥c /home/ec2-user.</li>
<li>Táº¡o thÃªm má»™t instance test Ä‘á»ƒ ping tá»›i loopback IP cá»§a á»©ng dá»¥ng HA.</li>
<li>CÃ³ thá»ƒ sá»­ dá»¥ng AWS Systems Manager Ä‘á»ƒ truy cáº­p vÃ  quáº£n lÃ½ cÃ¡c instance vá»«a táº¡o.</li>
</ul>
<p><strong>Tá»•ng quan giáº£i phÃ¡p</strong>
ChÃºng ta sá»­ dá»¥ng má»™t Ä‘á»‹a chá»‰ floating IP Ä‘Æ°á»£c cáº¥p tá»« dáº£i CIDR náº±m ngoÃ i VPC Ä‘á»ƒ á»©ng dá»¥ng sá»­ dá»¥ng. Client sáº½ káº¿t ná»‘i Ä‘áº¿n á»©ng dá»¥ng thÃ´ng qua Ä‘á»‹a chá»‰ IP nÃ y. Trong trÆ°á»ng há»£p instance chÃ­nh gáº·p sá»± cá»‘, toÃ n bá»™ lÆ°u lÆ°á»£ng gá»­i Ä‘áº¿n floating IP sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng chuyá»ƒn hÆ°á»›ng sang ENI cá»§a instance dá»± phÃ²ng á»Ÿ AZ thá»© hai. CÃ¡ch lÃ m nÃ y giÃºp giáº£m thiá»ƒu giÃ¡n Ä‘oáº¡n dá»‹ch vá»¥, nhá» Ã¡p dá»¥ng cÆ¡ cháº¿ floating IP káº¿t há»£p vá»›i Ä‘á»‹nh tuyáº¿n Ä‘á»™ng trong VPC, mÃ  khÃ´ng cáº§n cáº­p nháº­t cáº¥u hÃ¬nh phÃ­a client hay thá»±c hiá»‡n thao tÃ¡c thá»§ cÃ´ng.</p>
<p><div style="text-align:center;">
  <figure>
    <img src="/images/Img1-Blog2.png" alt="HÃ¬nh 1. Instance#1 Ä‘ang hoáº¡t Ä‘á»™ng">
    <figcaption><i>HÃ¬nh 1. Instance#1 Ä‘ang hoáº¡t Ä‘á»™ng</i></figcaption>
  </figure>
</div>
 </p>
<p>NhÆ° minh há»a á»Ÿ HÃ¬nh 1, á»©ng dá»¥ng hoáº¡t Ä‘á»™ng theo mÃ´ hÃ¬nh active/standby giá»¯a hai AZ. Cáº£ hai EC2 instance cÃ¹ng quáº£ng bÃ¡ má»™t Ä‘á»‹a chá»‰ loopback (vÃ­ dá»¥ 172.16.1.1/32) ra máº¡ng thÃ´ng qua phiÃªn BGP vá»›i hai VPC RSE náº±m trong cÃ¹ng má»™t subnet. Viá»‡c sá»­ dá»¥ng hai RSE nháº±m Ä‘áº£m báº£o tÃ­nh dá»± phÃ²ng vÃ  nÃ¢ng cao kháº£ nÄƒng sáºµn sÃ ng cá»§a dá»‹ch vá»¥ Ä‘á»‹nh tuyáº¿n.</p>
<div style="text-align:center;">
  <figure>
    <img src="/images/Img2-Blog2.png" alt="HÃ¬nh 2. CÃ¡c Ä‘iá»ƒm cuá»‘i (endpoint) cá»§a mÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n trong VPC">
    <figcaption><i>HÃ¬nh 2. CÃ¡c Ä‘iá»ƒm cuá»‘i (endpoint) cá»§a mÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n trong VPC</i></figcaption>
  </figure>
</div>

<div style="text-align:center;">
  <figure>
    <img src="/images/Img3-Blog2.png" alt="HÃ¬nh 3. CÃ¡c thiáº¿t bá»‹ ngang hÃ ng cá»§a mÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n trong VPC">
    <figcaption><i>HÃ¬nh 3. CÃ¡c thiáº¿t bá»‹ ngang hÃ ng cá»§a mÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n trong VPC</i></figcaption>
  </figure>
</div>

<div style="text-align:center;">
  <figure>
    <img src="/images/Img4-Blog2.png" alt="HÃ¬nh 4. Báº£ng RIB (Routing Information Base) cá»§a mÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n">
    <figcaption><i>HÃ¬nh 4. Báº£ng RIB (Routing Information Base) cá»§a mÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n</i></figcaption>
  </figure>
</div>

<p>Äá»ƒ Ä‘áº£m báº£o lÆ°u lÆ°á»£ng máº¡ng luÃ´n Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n instance Ä‘ang hoáº¡t Ä‘á»™ng, á»©ng dá»¥ng sá»­ dá»¥ng thuá»™c tÃ­nh BGP AS Path. Instance hoáº¡t Ä‘á»™ng sáº½ quáº£ng bÃ¡ tuyáº¿n vá»›i AS Path ngáº¯n hÆ¡n, trong khi instance dá»± phÃ²ng thÃªm nhiá»u sá»‘ AS khÃ¡c vÃ o Ä‘Æ°á»ng Ä‘i, khiáº¿n tuyáº¿n Ä‘Ã³ bá»‹ Æ°u tiÃªn tháº¥p hÆ¡n. Do BGP luÃ´n chá»n tuyáº¿n cÃ³ AS Path ngáº¯n nháº¥t, nÃªn tuyáº¿n tá»« instance hoáº¡t Ä‘á»™ng sáº½ Ä‘Æ°á»£c chá»n lÃ m tuyáº¿n chÃ­nh. NgoÃ i ra, cÃ¡c thuá»™c tÃ­nh khÃ¡c cá»§a BGP nhÆ° Multi-Exit Discriminator (MED) cÅ©ng cÃ³ thá»ƒ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒ thiáº¿t láº­p Æ°u tiÃªn Ä‘á»‹nh tuyáº¿n tÆ°Æ¡ng tá»±.</p>
<ol>
<li>
<p>Cáº£ instance hoáº¡t Ä‘á»™ng vÃ  dá»± phÃ²ng Ä‘á»u quáº£ng bÃ¡ Ä‘á»‹a chá»‰ 172.16.1.1/32 qua BGP Ä‘áº¿n cáº£ hai Route Server Endpoint (RSE) trong subnet cá»§a chÃºng.</p>
</li>
<li>
<p>MÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n VPC nháº­n Ä‘Æ°á»£c 4 quáº£ng bÃ¡ cho cÃ¹ng má»™t tiá»n tá»‘. Äiá»u nÃ y Ä‘Æ°á»£c minh há»a á»Ÿ HÃ¬nh 4, nÆ¡i loopback 172.16.1.1/32 Ä‘Æ°á»£c gá»­i Ä‘áº¿n tá»« cáº£ bá»‘n RSE.</p>
</li>
<li>
<p>Dá»±a vÃ o quy táº¯c chá»n Ä‘Æ°á»ng Ä‘i cá»§a BGP, mÃ¡y chá»§ Æ°u tiÃªn tuyáº¿n tá»« instance hoáº¡t Ä‘á»™ng vÃ¬ cÃ³ AS Path ngáº¯n hÆ¡n. Trong HÃ¬nh 4 thá»ƒ hiá»‡n rÃµ ráº±ng chá»‰ má»™t trong bá»‘n tuyáº¿n Ä‘Æ°á»£c chá»n vÃ  cÃ i Ä‘áº·t.</p>
</li>
<li>
<p>MÃ¡y chá»§ Ä‘á»‹nh tuyáº¿n VPC sau Ä‘Ã³ xÃ¡c Ä‘á»‹nh ENI gáº¯n vá»›i instance hoáº¡t Ä‘á»™ng vÃ  cáº­p nháº­t báº£ng Ä‘á»‹nh tuyáº¿n cá»§a VPC Ä‘á»ƒ chuyá»ƒn tiáº¿p lÆ°u lÆ°á»£ng tá»›i ENI-A cho Ä‘á»‹a chá»‰ 172.16.1.1/32.</p>
</li>
</ol>
<div style="text-align:center;">
  <figure>
    <img src="/images/Img5-Blog2.png" alt="HÃ¬nh 5. Báº£ng Ä‘á»‹nh tuyáº¿n VPC Ä‘Æ°á»£c cáº­p nháº­t, trong Ä‘Ã³ tuyáº¿n 172.16.1.1/32 trá» Ä‘áº¿n ENI cá»§a instance Ä‘ang hoáº¡t Ä‘á»™ng.">
    <figcaption><i>HÃ¬nh 5. Báº£ng Ä‘á»‹nh tuyáº¿n VPC Ä‘Æ°á»£c cáº­p nháº­t, trong Ä‘Ã³ tuyáº¿n 172.16.1.1/32 trá» Ä‘áº¿n ENI cá»§a instance Ä‘ang hoáº¡t Ä‘á»™ng.</i></figcaption>
  </figure>
</div>

<p>Báº¡n cÃ³ thá»ƒ kiá»ƒm tra cáº¥u hÃ¬nh Gobgp báº±ng cÃ¡ch káº¿t ná»‘i vÃ o má»™t trong cÃ¡c instance (instance-rs-az1 hoáº·c instance-rs-az2) thÃ´ng qua <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/session-manager.html" rel="external" target="_blank">EC2 Session Manager</a>.</p>
<p>Tá»‡p cáº¥u hÃ¬nh Gobgp náº±m táº¡i /home/ec2-user/gobgpd.conf.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sh-5.2$ sudo more /home/ec2-user/gobgpd.conf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>global.config<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>as <span style="color:#f92672">=</span> <span style="color:#ae81ff">65001</span>
</span></span><span style="display:flex;"><span>router-id <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.0.1.203&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span>neighbors<span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>neighbors.config<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>neighbor-address <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.0.1.230&#34;</span>
</span></span><span style="display:flex;"><span>peer-as <span style="color:#f92672">=</span> <span style="color:#ae81ff">65000</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span>neighbors.afi-safis<span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>neighbors.afi-safis.config<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>afi-safi-name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ipv4-unicast&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span>neighbors<span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>neighbors.config<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>neighbor-address <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;10.0.1.136&#34;</span>
</span></span><span style="display:flex;"><span>peer-as <span style="color:#f92672">=</span> <span style="color:#ae81ff">65000</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[[</span>neighbors.afi-safis<span style="color:#f92672">]]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>neighbors.afi-safis.config<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>afi-safi-name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;ipv4-unicast&#34;</span></span></span></code></pre></div>
<p>Sá»­ dá»¥ng lá»‡nh sau Ä‘á»ƒ kiá»ƒm tra tráº¡ng thÃ¡i BGP neighbor. Káº¿t quáº£ sáº½ hiá»ƒn thá»‹ hai neighbor, tÆ°Æ¡ng á»©ng vá»›i hai VPC RSE trong subnet cá»§a instance.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sh-5.2$ sudo /home/ec2-user/gobgp neighbor
</span></span><span style="display:flex;"><span>Peer            AS     Up/Down   State   |<span style="color:#75715e">#Received Accepted</span>
</span></span><span style="display:flex;"><span>10.0.1.136      <span style="color:#ae81ff">65000</span>  22:43:07  Establ  | <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>10.0.1.230      <span style="color:#ae81ff">65000</span>  22:43:08  Establ  | <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">0</span></span></span></code></pre></div>
<p>Kiá»ƒm tra ráº±ng tuyáº¿n loopback Ä‘Ã£ Ä‘Æ°á»£c quáº£ng bÃ¡ qua BGP:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sh-5.2$ sudo /home/ec2-user/gobgp global rib
</span></span><span style="display:flex;"><span>   Network      Next Hop  AS_PATH  Age       Attrs
</span></span><span style="display:flex;"><span>*&gt; 172.16.1.1/32 0.0.0.0           22:42:21  <span style="color:#f92672">[{</span>Origin: ?<span style="color:#f92672">}]</span></span></span></code></pre></div>
<p>Äá»ƒ kiá»ƒm tra thiáº¿t láº­p Ä‘á»‹nh tuyáº¿n, báº¡n cÃ³ thá»ƒ truy cáº­p vÃ o instance kiá»ƒm thá»­ (test-instance) báº±ng phÆ°Æ¡ng phÃ¡p Systems Manager. Sau khi Ä‘Äƒng nháº­p thÃ nh cÃ´ng, hÃ£y ping Ä‘áº¿n Ä‘á»‹a chá»‰ 172.16.1.1. Báº¡n sáº½ nháº­n Ä‘Æ°á»£c pháº£n há»“i xuáº¥t phÃ¡t tá»« instance Ä‘ang hoáº¡t Ä‘á»™ng â€œinstance-rs-az1â€.</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sh-5.2$ ping 172.16.1.1
</span></span><span style="display:flex;"><span>PING 172.16.1.1 <span style="color:#f92672">(</span>172.16.1.1<span style="color:#f92672">)</span> 56<span style="color:#f92672">(</span>84<span style="color:#f92672">)</span> bytes of data.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">64</span> bytes from 172.16.1.1: icmp_seq<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span> time<span style="color:#f92672">=</span>0.712 ms
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">64</span> bytes from 172.16.1.1: icmp_seq<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span> time<span style="color:#f92672">=</span>0.338 ms
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">64</span> bytes from 172.16.1.1: icmp_seq<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span> time<span style="color:#f92672">=</span>0.378 ms</span></span></code></pre></div>
<h3 id="phÃ¡t-hiá»‡n-vÃ -khÃ´i-phá»¥c-khi-xáº£y-ra-failover">PhÃ¡t hiá»‡n vÃ  khÃ´i phá»¥c khi xáº£y ra Failover</h3>
<p>Äá»ƒ mÃ´ phá»ng má»™t tÃ¬nh huá»‘ng failover, báº¡n cÃ³ thá»ƒ táº¯t instance Ä‘ang hoáº¡t Ä‘á»™ng (instance-rs-az1).</p>
<ol>
<li>
<p>Náº¿u instance Ä‘ang hoáº¡t Ä‘á»™ng gáº·p sá»± cá»‘ hoáº·c khÃ´ng thá»ƒ truy cáº­p, BGP sáº½ phÃ¡t hiá»‡n lá»—i trong khoáº£ng thá»i gian timeout Ä‘Ã£ cáº¥u hÃ¬nh.</p>
</li>
<li>
<p>VPC Route Server Ä‘Ã¡nh dáº¥u phiÃªn BGP vá»›i instance Ä‘ang hoáº¡t Ä‘á»™ng lÃ  down vÃ  rÃºt tuyáº¿n Ä‘Æ°á»ng ra khá»i báº£ng RIB.</p>
</li>
<li>
<p>Má»™t quÃ¡ trÃ¬nh BGP re-convergence Ä‘Æ°á»£c kÃ­ch hoáº¡t, vÃ  tuyáº¿n Ä‘Æ°á»ng do instance dá»± phÃ²ng quáº£ng bÃ¡ sáº½ Ä‘Æ°á»£c chá»n lÃ m Ä‘Æ°á»ng Ä‘i tá»‘t nháº¥t.</p>
</li>
<li>
<p>Báº£ng Ä‘á»‹nh tuyáº¿n VPC Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ chuyá»ƒn tiáº¿p lÆ°u lÆ°á»£ng Ä‘áº¿n 172.16.1.1/32 qua ENI cá»§a instance dá»± phÃ²ng (ENI-B).</p>
</li>
<li>
<p>LÆ°u lÆ°á»£ng Ä‘Æ°á»£c chuyá»ƒn tiáº¿p liá»n máº¡ch sang instance dá»± phÃ²ng, duy trÃ¬ tÃ­nh sáºµn sÃ ng cá»§a á»©ng dá»¥ng mÃ  khÃ´ng gÃ¢y giÃ¡n Ä‘oáº¡n cho client.</p>
</li>
</ol>
<p>Äá»ƒ kiá»ƒm tra thiáº¿t láº­p Ä‘á»‹nh tuyáº¿n, báº¡n cÃ³ thá»ƒ truy cáº­p vÃ o instance kiá»ƒm thá»­ (test-instance) báº±ng phÆ°Æ¡ng phÃ¡p Systems Manager. Sau khi Ä‘Äƒng nháº­p, hÃ£y ping Ä‘áº¿n 172.16.1.1. Báº¡n sáº½ nháº­n Ä‘Æ°á»£c pháº£n há»“i tá»« instance hiá»‡n táº¡i Ä‘ang hoáº¡t Ä‘á»™ng (instance-rs-az2).</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sh-5.2$ ping 172.16.1.1
</span></span><span style="display:flex;"><span>PING 172.16.1.1 <span style="color:#f92672">(</span>172.16.1.1<span style="color:#f92672">)</span> 56<span style="color:#f92672">(</span>84<span style="color:#f92672">)</span> bytes of data.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">64</span> bytes from 172.16.1.1: icmp_seq<span style="color:#f92672">=</span><span style="color:#ae81ff">1</span> ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span> time<span style="color:#f92672">=</span>0.712 ms
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">64</span> bytes from 172.16.1.1: icmp_seq<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span> ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span> time<span style="color:#f92672">=</span>0.338 ms
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">64</span> bytes from 172.16.1.1: icmp_seq<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> ttl<span style="color:#f92672">=</span><span style="color:#ae81ff">127</span> time<span style="color:#f92672">=</span>0.378 ms</span></span></code></pre></div>
<div style="text-align:center;">
  <figure>
    <img src="/images/Img6-Blog2.png" alt="HÃ¬nh 6. Instance2 Ä‘áº£m nháº­n vai trÃ² hoáº¡t Ä‘á»™ng">
    <figcaption><i>HÃ¬nh 6. Instance2 Ä‘áº£m nháº­n vai trÃ² hoáº¡t Ä‘á»™ng</i></figcaption>
  </figure>
</div>

<div style="text-align:center;">
  <figure>
    <img src="/images/Img7-Blog2.png" alt="HÃ¬nh 7. Báº£ng Ä‘á»‹nh tuyáº¿n Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ trá» Ä‘áº¿n ENI cá»§a Inst2">
    <figcaption><i>HÃ¬nh 7. Báº£ng Ä‘á»‹nh tuyáº¿n Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ trá» Ä‘áº¿n ENI cá»§a Inst2</i></figcaption>
  </figure>
</div>

<p><strong>TÃ¬nh huá»‘ng #2: Kiá»ƒm tra lÆ°u lÆ°á»£ng ingress VPC</strong></p>
<p>HÃ£y xem xÃ©t ká»‹ch báº£n khi báº¡n cÃ³ má»™t mÃ´ hÃ¬nh báº£o máº­t táº­p trung, trong Ä‘Ã³ cÃ¡c thiáº¿t bá»‹ tÆ°á»ng lá»­a (Ä‘Æ°á»£c triá»ƒn khai dÆ°á»›i dáº¡ng EC2 instance) sáº½ kiá»ƒm tra toÃ n bá»™ lÆ°u lÆ°á»£ng north-south hoáº·c east-west trong VPC cá»§a báº¡n. CÃ¡c tÆ°á»ng lá»­a nÃ y Ä‘Ã³ng vai trÃ² then chá»‘t trong tÆ° tháº¿ báº£o máº­t vÃ  pháº£i luÃ´n kháº£ dá»¥ng Ä‘á»ƒ kiá»ƒm tra cÅ©ng nhÆ° chuyá»ƒn tiáº¿p lÆ°u lÆ°á»£ng. Äá»ƒ duy trÃ¬ tÃ­nh sáºµn sÃ ng cao, báº¡n triá»ƒn khai hai EC2 firewall á»Ÿ hai AZ khÃ¡c nhau. Má»¥c tiÃªu lÃ  Ä‘áº£m báº£o ráº±ng náº¿u firewall Ä‘ang hoáº¡t Ä‘á»™ng gáº·p sá»± cá»‘, thÃ¬ lÆ°u lÆ°á»£ng sáº½ Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng liá»n máº¡ch sang firewall dá»± phÃ²ng.</p>
<p>Trong ká»‹ch báº£n nÃ y, chÃºng ta minh há»a cÃ¡ch triá»ƒn khai tÃ­nh kháº£ dá»¥ng cao (HA) vÃ  cÆ¡ cháº¿ failover cho cÃ¡c firewall stateful Ä‘Æ°á»£c triá»ƒn khai trÃªn nhiá»u AZ trong AWS, báº±ng cÃ¡ch sá»­ dá»¥ng VPC Route Server vÃ  cáº­p nháº­t Ä‘á»‹nh tuyáº¿n Ä‘á»™ng.</p>
<p>Tá»•ng quan giáº£i phÃ¡p
Táº¥t cáº£ lÆ°u lÆ°á»£ng Ä‘i vÃ o VPC thÃ´ng qua IGW sáº½ Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n firewall Ä‘á»ƒ kiá»ƒm tra trÆ°á»›c khi Ä‘i vÃ o application subnet. TÆ°Æ¡ng tá»±, toÃ n bá»™ lÆ°u lÆ°á»£ng Ä‘i ra tá»« application subnet cÅ©ng sáº½ Ä‘Æ°á»£c Ä‘á»‹nh tuyáº¿n Ä‘áº¿n firewall Ä‘á»ƒ kiá»ƒm tra trÆ°á»›c khi Ä‘Æ°á»£c gá»­i ra internet.</p>
<p>HÃ¬nh dÆ°á»›i Ä‘Ã¢y minh há»a má»™t thiáº¿t bá»‹ firewall Ä‘Æ°á»£c cÃ i Ä‘áº·t trÃªn má»™t EC2 instance trong subnet A. Thiáº¿t bá»‹ nÃ y sáº½ kiá»ƒm tra toÃ n bá»™ lÆ°u lÆ°á»£ng Ä‘i tá»« IGW Ä‘áº¿n subnet B (application subnet) vÃ  tá»« subnet B ra IGW.</p>
<div style="text-align:center;">
  <figure>
    <img src="/images/Img8-Blog2.png" alt="HÃ¬nh 8. TÃ¬nh huá»‘ng #2 khi firewall 1 Ä‘ang hoáº¡t Ä‘á»™ng">
    <figcaption><i>HÃ¬nh 8. TÃ¬nh huá»‘ng #2 khi firewall 1 Ä‘ang hoáº¡t Ä‘á»™ng</i></figcaption>
  </figure>
</div>

<p>Má»—i firewall thiáº¿t láº­p bá»‘n phiÃªn BGP: hai cho subnet A vÃ  hai cho subnet B, bao gá»“m cáº£ subnet á»©ng dá»¥ng vÃ  báº£ng Ä‘á»‹nh tuyáº¿n IGW.</p>
<p>Äá»ƒ Ä‘áº£m báº£o chá»‰ cÃ³ má»™t firewall Ä‘Æ°á»£c sá»­ dá»¥ng táº¡i má»™t thá»i Ä‘iá»ƒm, Ä‘á»™ Æ°u tiÃªn Ä‘Æ°á»ng Ä‘i trong BGP Ä‘Æ°á»£c Ä‘iá»u chá»‰nh báº±ng cÃ¡ch sá»­ dá»¥ng cÃ¡c metric cá»§a BGP. ChÃºng ta táº­p trung vÃ o cÃ¡c metric sau:</p>
<ul>
<li>
<p>AS_Path: Thuá»™c tÃ­nh BGP cho tháº¥y chuá»—i cÃ¡c sá»‘ hiá»‡u Há»‡ thá»‘ng Tá»± trá»‹ (AS) mÃ  má»™t tuyáº¿n Ä‘Æ°á»ng Ä‘Ã£ Ä‘i qua. NÃ³ vá»«a Ä‘Ã³ng vai trÃ² lÃ  cÆ¡ cháº¿ ngÄƒn vÃ²ng láº·p, vá»«a lÃ  tiÃªu chÃ­ lá»±a chá»n Ä‘Æ°á»ng Ä‘i, trong Ä‘Ã³ Ä‘Æ°á»ng Ä‘i ngáº¯n hÆ¡n sáº½ Ä‘Æ°á»£c Æ°u tiÃªn.</p>
</li>
<li>
<p>MED (Multi-Exit Discriminator): Thuá»™c tÃ­nh BGP Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ áº£nh hÆ°á»Ÿng Ä‘áº¿n lÆ°u lÆ°á»£ng vÃ o báº±ng cÃ¡ch Ä‘á» xuáº¥t Ä‘iá»ƒm vÃ o Æ°a thÃ­ch khi tá»“n táº¡i nhiá»u káº¿t ná»‘i giá»¯a hai há»‡ thá»‘ng tá»± trá»‹. GiÃ¡ trá»‹ MED tháº¥p hÆ¡n sáº½ Ä‘Æ°á»£c Æ°u tiÃªn.</p>
</li>
</ul>
<p>Firewall Ä‘ang hoáº¡t Ä‘á»™ng sáº½ quáº£ng bÃ¡ cÃ¡c prefix vá»›i thuá»™c tÃ­nh BGP Æ°u tiÃªn cao nháº¥t, trong khi firewall dá»± phÃ²ng quáº£ng bÃ¡ cÃ¹ng prefix nhÆ°ng vá»›i cÃ¡c thuá»™c tÃ­nh Ã­t Æ°u tiÃªn hÆ¡n. Trong ká»‹ch báº£n nÃ y, chÃºng ta sá»­ dá»¥ng AS path prepending, trong Ä‘Ã³ firewall dá»± phÃ²ng sáº½ tÄƒng Ä‘á»™ dÃ i AS path khi quáº£ng bÃ¡ prefix Ä‘áº¿n RSE.</p>
<p><strong>Báº£ng Ä‘á»‹nh tuyáº¿n Internet Gateway</strong></p>
<p>CÃ¡c báº£ng Ä‘á»‹nh tuyáº¿n gáº¯n vá»›i IGW (Internet Gateway) kiá»ƒm soÃ¡t Ä‘Æ°á»ng Ä‘i mÃ  lÆ°u lÆ°á»£ng internet Ä‘i vÃ o VPC sáº½ sá»­ dá»¥ng. NgÆ°á»i dÃ¹ng thÆ°á»ng dÃ¹ng nÃ³ Ä‘á»ƒ chÃ¨n firewall vÃ  cÃ¡c chá»©c nÄƒng máº¡ng áº£o khÃ¡c vÃ o Ä‘Æ°á»ng Ä‘i cá»§a lÆ°u lÆ°á»£ng internet inbound.</p>
<p>Cáº£ firewall hoáº¡t Ä‘á»™ng vÃ  firewall dá»± phÃ²ng Ä‘á»u Ä‘Æ°á»£c káº¿t ná»‘i vá»›i VPC Route Server vÃ  quáº£ng bÃ¡ CIDR cá»§a subnet á»©ng dá»¥ng Ä‘áº¿n cÃ¡c RSE. Tuy nhiÃªn, firewall dá»± phÃ²ng quáº£ng bÃ¡ tuyáº¿n vá»›i AS path dÃ i hÆ¡n. VPC Route Server sáº½ cháº¡y thuáº­t toÃ¡n chá»n Ä‘Æ°á»ng tá»‘t nháº¥t cá»§a BGP vÃ  cÃ i Ä‘áº·t tuyáº¿n Ä‘Æ°á»£c quáº£ng bÃ¡ bá»Ÿi firewall hoáº¡t Ä‘á»™ng.</p>
<p>Báº£ng Ä‘á»‹nh tuyáº¿n cho subnet IGW cÃ³ tuyáº¿n nhÆ° sau:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Application subnet CIDR ---&gt; Active Firewall ENI</span></span></code></pre></div>
<p>VPC sáº½ Ä‘á»‹nh tuyáº¿n lÆ°u lÆ°á»£ng cÃ³ Ä‘Ã­ch Ä‘áº¿n subnet á»©ng dá»¥ng Ä‘áº¿n ENI cá»§a firewall hoáº¡t Ä‘á»™ng.</p>
<p><strong>Báº£ng Ä‘á»‹nh tuyáº¿n cá»§a subnet á»©ng dá»¥ng</strong>
Cáº£ tÆ°á»ng lá»­a Ä‘ang hoáº¡t Ä‘á»™ng láº«n dá»± phÃ²ng Ä‘á»u Ä‘Æ°á»£c káº¿t ná»‘i vá»›i VPC Route Server vÃ  Ä‘á»u quáº£ng bÃ¡ Ä‘á»‹a chá»‰ 0.0.0.0/0 Ä‘áº¿n cÃ¡c RSE. Tuy nhiÃªn, tÆ°á»ng lá»­a dá»± phÃ²ng quáº£ng bÃ¡ 0.0.0.0/0 vá»›i má»™t Ä‘Æ°á»ng dáº«n AS dÃ i hÆ¡n. VPC Route Server sáº½ cháº¡y thuáº­t toÃ¡n BGP Ä‘á»ƒ chá»n tuyáº¿n Ä‘Æ°á»ng tá»‘t nháº¥t vÃ  chá»‰ sá»­ dá»¥ng tuyáº¿n Ä‘Æ°á»£c quáº£ng bÃ¡ bá»Ÿi tÆ°á»ng lá»­a Ä‘ang hoáº¡t Ä‘á»™ng.</p>
<p>Báº£ng Ä‘á»‹nh tuyáº¿n cá»§a subnet á»©ng dá»¥ng cÃ³ tuyáº¿n nhÆ° sau:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>0.0.0.0/0 ---&gt; ENI cá»§a tÆ°á»ng lá»­a Ä‘ang hoáº¡t Ä‘á»™ng</span></span></code></pre></div>
<p>Äiá»u nÃ y cÃ³ nghÄ©a lÃ  má»i lÆ°u lÆ°á»£ng tá»« server á»©ng dá»¥ng sáº½ Ä‘i qua tÆ°á»ng lá»­a Ä‘ang hoáº¡t Ä‘á»™ng trÆ°á»›c khi ra Internet.</p>
<p><strong>Báº£ng Ä‘á»‹nh tuyáº¿n cá»§a subnet tÆ°á»ng lá»­a</strong></p>
<p>Báº£ng Ä‘á»‹nh tuyáº¿n cá»§a subnet dÃ nh cho tÆ°á»ng lá»­a cÃ³ tuyáº¿n tÄ©nh sau:</p>
<div class="highlight wrap-code" dir="auto"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>0.0.0.0/0 ---&gt; igw-id</span></span></code></pre></div>
<p>Tá»©c lÃ  táº¥t cáº£ lÆ°u lÆ°á»£ng tá»« Ä‘Ã¢y sáº½ Ä‘Æ°á»£c gá»­i tháº³ng ra Internet Gateway (IGW).</p>
<p><strong>PhÃ¡t hiá»‡n chuyá»ƒn Ä‘á»•i dá»± phÃ²ng vá»›i BFD</strong></p>
<p>BFD Ä‘Æ°á»£c báº­t trÃªn má»—i phiÃªn BGP giá»¯a cÃ¡c tÆ°á»ng lá»­a vÃ  cÃ¡c RSE cá»§a VPC. BFD cho phÃ©p phÃ¡t hiá»‡n sá»± cá»‘ ráº¥t nhanh â€” thÆ°á»ng dÆ°á»›i má»™t giÃ¢y â€” báº±ng cÃ¡ch liÃªn tá»¥c trao Ä‘á»•i cÃ¡c gÃ³i Ä‘iá»u khiá»ƒn.</p>
<p>Trong trÆ°á»ng há»£p tÆ°á»ng lá»­a gáº·p sá»± cá»‘:</p>
<ol>
<li>
<p>BFD phÃ¡t hiá»‡n phiÃªn BGP giá»¯a tÆ°á»ng lá»­a Ä‘ang hoáº¡t Ä‘á»™ng vÃ  cÃ¡c RSE bá»‹ lá»—i.</p>
</li>
<li>
<p>CÃ¡c RSE Ä‘Ã¡nh dáº¥u phiÃªn BGP nÃ y lÃ  DOWN.</p>
</li>
<li>
<p>CÃ¡c RSE rÃºt láº¡i cÃ¡c tuyáº¿n Æ°u tiÃªn (bao gá»“m cáº£ tiá»n tá»‘ ná»™i bá»™ vÃ  bÃªn ngoÃ i) mÃ  tÆ°á»ng lá»­a bá»‹ lá»—i Ä‘ang quáº£ng bÃ¡.</p>
</li>
<li>
<p>QuÃ¡ trÃ¬nh há»™i tá»¥ láº¡i BGP diá»…n ra â€” cÃ¡c RSE chá»n tuyáº¿n thay tháº¿ (dá»± phÃ²ng) Ä‘Æ°á»£c quáº£ng bÃ¡ bá»Ÿi tÆ°á»ng lá»­a cÃ²n hoáº¡t Ä‘á»™ng.</p>
</li>
<li>
<p>Tuyáº¿n nÃ y trá»Ÿ thÃ nh tuyáº¿n active trong báº£ng Ä‘iá»u khiá»ƒn Ä‘á»‹nh tuyáº¿n cá»§a VPC.</p>
</li>
<li>
<p>LÆ°u lÆ°á»£ng tá»± Ä‘á»™ng Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng sang tÆ°á»ng lá»­a dá»± phÃ²ng.</p>
</li>
</ol>
<div style="text-align:center;">
  <figure>
    <img src="/images/Img9-Blog2.png" alt="HÃ¬nh 9. TÆ°á»ng lá»­a FW1 gáº·p sá»± cá»‘ dáº«n Ä‘áº¿n lÆ°u lÆ°á»£ng Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng sang FW2.">
    <figcaption><i>HÃ¬nh 9. TÆ°á»ng lá»­a FW1 gáº·p sá»± cá»‘ dáº«n Ä‘áº¿n lÆ°u lÆ°á»£ng Ä‘Æ°á»£c chuyá»ƒn hÆ°á»›ng sang FW2.</i></figcaption>
  </figure>
</div>

<p>Phá»¥c há»“i/Quay láº¡i (Failback/Recovery)
Khi tÆ°á»ng lá»­a bá»‹ lá»—i phá»¥c há»“i vÃ  thiáº¿t láº­p láº¡i cÃ¡c phiÃªn BGP vÃ  BFD:</p>
<ol>
<li>
<p>NÃ³ báº¯t Ä‘áº§u quáº£ng bÃ¡ láº¡i cÃ¡c thuá»™c tÃ­nh BGP Æ°u tiÃªn.</p>
</li>
<li>
<p>CÃ¡c RSE phÃ¡t hiá»‡n tuyáº¿n Ä‘Æ°á»ng háº¥p dáº«n hÆ¡n vÃ  chuyá»ƒn lÆ°u lÆ°á»£ng trá»Ÿ láº¡i tÆ°á»ng lá»­a Ä‘Ã£ Ä‘Æ°á»£c phá»¥c há»“i.</p>
</li>
</ol>
<p>QuÃ¡ trÃ¬nh nÃ y cÃ³ thá»ƒ Ä‘Æ°á»£c tá»± Ä‘á»™ng hÃ³a hoáº·c Ä‘iá»u khiá»ƒn theo chÃ­nh sÃ¡ch quáº£n trá»‹ (vÃ­ dá»¥: chuyá»ƒn Ä‘á»•i dá»± phÃ²ng Æ°u tiÃªn hoáº·c khÃ´ng Æ°u tiÃªn).</p>
<p>Æ¯u Ä‘iá»ƒm cá»§a viá»‡c sá»­ dá»¥ng VPC Route Server vá»›i Failover dá»±a trÃªn BGP + BFD:</p>
<ol>
<li>
<p>Há»™i tá»¥ nhanh: PhÃ¡t hiá»‡n sá»± cá»‘ dÆ°á»›i má»™t giÃ¢y nhá» BFD.</p>
</li>
<li>
<p>HoÃ n toÃ n tá»± Ä‘á»™ng: KhÃ´ng cáº§n script hay can thiá»‡p thá»§ cÃ´ng.</p>
</li>
<li>
<p>Má»Ÿ rá»™ng dá»… dÃ ng: Hoáº¡t Ä‘á»™ng trÃªn nhiá»u tiá»n tá»‘ vÃ  instance.</p>
</li>
<li>
<p>Äiá»u khiá»ƒn gá»‘c Ä‘Ã¡m mÃ¢y: TÃ­ch há»£p trá»±c tiáº¿p vá»›i lá»›p Ä‘á»‹nh tuyáº¿n cá»§a VPC.</p>
</li>
<li>
<p>Chuáº©n hÃ³a giao thá»©c: Sá»­ dá»¥ng hÃ nh vi BGP theo tiÃªu chuáº©n ngÃ nh.</p>
</li>
</ol>
<p><strong>Nhá»¯ng Ä‘iá»ƒm cáº§n lÆ°u Ã½</strong></p>
<ol>
<li>
<p>QuÃ¡ trÃ¬nh há»™i tá»¥ láº¡i Ä‘á»‹nh tuyáº¿n cÃ³ thá»ƒ gÃ¢y ra má»™t khoáº£ng thá»i gian giÃ¡n Ä‘oáº¡n. Náº¿u á»©ng dá»¥ng Ä‘Ã£ tÃ­ch há»£p vá»›i GWLB, hÃ£y cÃ¢n nháº¯c sá»­ dá»¥ng GWLB lÃ m lá»±a chá»n Ä‘áº§u tiÃªn cho viá»‡c chuyá»ƒn Ä‘á»•i dá»± phÃ²ng á»©ng dá»¥ng.</p>
</li>
<li>
<p>Äáº£m báº£o táº¯t tÃ­nh nÄƒng route propagation náº¿u báº¡n Ä‘ang quáº£n lÃ½ tuyáº¿n Ä‘Æ°á»ng thá»§ cÃ´ng.</p>
</li>
<li>
<p>Sá»­ dá»¥ng BFD hoáº·c cÃ¡c cÃ´ng cá»¥ phÃ¡t hiá»‡n sá»± cá»‘ nhanh khÃ¡c Ä‘á»ƒ há»™i tá»¥ nhanh hÆ¡n.</p>
</li>
<li>
<p>Äáº£m báº£o cÃ¡c tuyáº¿n Ä‘Æ°á»ng Ä‘á»‘i xá»©ng náº¿u báº¡n thá»±c hiá»‡n kiá»ƒm tra Ä‘Æ°á»ng tráº£ vá» (return-path inspection).</p>
</li>
<li>
<p>Báº­t giÃ¡m sÃ¡t vÃ  cáº£nh bÃ¡o Ä‘á»ƒ theo dÃµi tÃ¬nh tráº¡ng há»‡ thá»‘ng, cÃ¡c thay Ä‘á»•i vá» tuyáº¿n Ä‘Æ°á»ng vÃ  cÃ¡c sá»± kiá»‡n chuyá»ƒn Ä‘á»•i dá»± phÃ²ng.</p>
</li>
</ol>
<p><strong>Káº¿t luáº­n</strong>
Trong bÃ i viáº¿t nÃ y, chÃºng ta Ä‘Ã£ tÃ¬m hiá»ƒu cÃ¡ch sá»­ dá»¥ng Amazon VPC Route Server Ä‘á»ƒ xÃ¢y dá»±ng cÃ¡c thiáº¿t káº¿ máº¡ng trong Ä‘Ã¡m mÃ¢y cÃ³ kháº£ nÄƒng má»Ÿ rá»™ng, chá»‹u lá»—i vÃ  an toÃ n, báº±ng cÃ¡ch báº­t tÃ­nh nÄƒng chuyá»ƒn Ä‘á»•i dá»± phÃ²ng cho cÃ¡c á»©ng dá»¥ng quan trá»ng vÃ  triá»ƒn khai kiáº¿n trÃºc kháº£ dá»¥ng cao. ChÃºng tÃ´i Ä‘Ã£ giá»›i thiá»‡u hai mÃ´ hÃ¬nh kiáº¿n trÃºc khÃ¡c nhau vÃ  cung cáº¥p cÃ¡c chi tiáº¿t triá»ƒn khai. VPC Route Server má»Ÿ ra cÃ¡c kháº£ nÄƒng Ä‘á»‹nh tuyáº¿n nÃ¢ng cao trong AWS báº±ng cÃ¡ch tÃ­ch há»£p cÃ¡c giao thá»©c BGP vÃ  BFD theo tiÃªu chuáº©n ngÃ nh vÃ o máº¡ng VPC gá»‘c. Äá»ƒ báº¯t Ä‘áº§u vá»›i VPC Route Server ngay hÃ´m nay, báº¡n cÃ³ thá»ƒ tham kháº£o <a href="https://docs.aws.amazon.com/vpc/latest/userguide/dynamic-routing-route-server.html" rel="external" target="_blank">tÃ i liá»‡u</a> vÃ  hÆ°á»›ng dáº«n  <a href="https://docs.aws.amazon.com/vpc/latest/userguide/route-server-tutorial.html" rel="external" target="_blank">Amazon VPC Route Server Get Started</a>.</p>
<p>Cáº­p nháº­t: VÃ o ngÃ y 15 thÃ¡ng 9 nÄƒm 2025, phiÃªn báº£n trÆ°á»›c cá»§a bÃ i viáº¿t cÃ³ sá»­ dá»¥ng cÃ¡c biá»ƒu tÆ°á»£ng kiáº¿n trÃºc AWS Ä‘Ã£ lá»—i thá»i. BÃ i viáº¿t Ä‘Ã£ Ä‘Æ°á»£c cáº­p nháº­t Ä‘á»ƒ pháº£n Ã¡nh bá»™ biá»ƒu tÆ°á»£ng kiáº¿n trÃºc AWS hiá»‡n táº¡i.</p>
<p>Link bÃ i viáº¿t gá»‘c: (<a href="https://aws.amazon.com/blogs/networking-and-content-delivery/dynamic-routing-using-amazon-vpc-route-server/" rel="external" target="_blank">https://aws.amazon.com/blogs/networking-and-content-delivery/dynamic-routing-using-amazon-vpc-route-server/</a>)</p>

  <footer class="footline">
  </footer>
</article>
        </div>
      </main>
    </div>
    <aside id="R-sidebar" class="default-animation">
      <div id="R-header-topbar" class="default-animation"></div>
      <div id="R-header-wrapper" class="default-animation">
        <div id="R-header" class="default-animation">
          <a id="R-logo" class="R-default" href="/en/index.html">
            <div class="logo-title">Internship Report</div>
          </a>
        </div>
        <search><form action="/en/search/index.html" method="get">
          <div class="searchbox default-animation">
            <button class="search-detail" type="submit" title="Search (CTRL+ALT+f)"><i class="fas fa-search"></i></button>
            <label class="a11y-only" for="R-search-by">Search</label>
            <input data-search-input id="R-search-by" name="search-by" class="search-by" type="search" placeholder="Search...">
            <button class="search-clear" type="button" data-search-clear="" title="Clear search"><i class="fas fa-times" title="Clear search"></i></button>
          </div>
        </form></search>
      </div>
      <div id="R-homelinks" class="default-animation homelinks">
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-homelinks">
          <ul class="space collapsible-menu">
            <li class="" data-nav-id="/en/index.html"><a class="padding" href="/en/index.html"><i class="fa-fw fas fa-home"></i> Home</a></li>
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-headercontrols">
          <ul class="">
          </ul>
        </div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
      </div>
      <div id="R-content-wrapper" class="highlightable">
        <div class="R-sidebarmenu R-shortcutmenu-main">
          <ul class="enlarge morespace collapsible-menu">
            <li class="" data-nav-id="/en/1-worklog/index.html"><a class="padding" href="/en/1-worklog/index.html"><b>1. </b>Worklog</a><ul id="R-subsections-16447363d800ec5deaa3b0a76c63c922" class="collapsible-menu"></ul></li>
            <li class="" data-nav-id="/en/2-proposal/index.html"><a class="padding" href="/en/2-proposal/index.html"><b>2. </b>Proposal</a></li>
            <li class="parent " data-nav-id="/en/3-translated_blogs/index.html"><a class="padding" href="/en/3-translated_blogs/index.html"><b>3. </b>Translated Blogs</a><ul id="R-subsections-0acade1cd81cfef73c977718aa56c877" class="collapsible-menu">
            <li class="" data-nav-id="/en/3-translated_blogs/blog_1/index.html"><a class="padding" href="/en/3-translated_blogs/blog_1/index.html"><b>3.1. </b>Blog 1</a></li>
            <li class="active " data-nav-id="/en/3-translated_blogs/blog_2/index.html"><a class="padding" href="/en/3-translated_blogs/blog_2/index.html"> <b> 3.2. </b>Blog 2</a></li>
            <li class="" data-nav-id="/en/3-translated_blogs/blog_3/index.html"><a class="padding" href="/en/3-translated_blogs/blog_3/index.html"> <b> 3.3. </b>Blog 3</a></li>
            <li class="" data-nav-id="/en/3-translated_blogs/blog_4/index.html"><a class="padding" href="/en/3-translated_blogs/blog_4/index.html"> <b> 3.4. </b>Blog 4</a></li></ul></li>
            <li class="" data-nav-id="/en/4-events-participated/index.html"><a class="padding" href="/en/4-events-participated/index.html"><b>4. </b>Events Participated</a></li>
            <li class="" data-nav-id="/en/5-workshop/index.html"><a class="padding" href="/en/5-workshop/index.html"><b>5. </b>Workshop</a></li>
            <li class="" data-nav-id="/en/6-self-assesment/index.html"><a class="padding" href="/en/6-self-assesment/index.html"><b>6. </b>Self Assesment</a></li>
            <li class="" data-nav-id="/en/7-sharing-and-feedback/index.html"><a class="padding" href="/en/7-sharing-and-feedback/index.html"><b>7. </b>Sharing and Feedback</a></li>
          </ul>
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-shortcuts">
          <ul class="space collapsible-menu">
          </ul>
        </div>
        <div id="R-footer-margin"></div>
        <div class="R-menu-divider default-animation">
          <hr class="padding">
        </div>
        <div class="R-sidebarmenu R-shortcutmenu-footercontrols">
          <ul class="">
			<li class="R-languageswitcher">
              <div class="padding menu-control">
                <i class="fa-fw fas fa-language"></i>
                <span>&nbsp;</span>
                <div class="control-style">
                  <label class="a11y-only" for="R-select-language">Language</label>
                  <select id="R-select-language">
                    <option id="R-select-language-en" value="en" data-url="/en/3-translated_blogs/blog_2/index.html" lang="en" selected data-selected>English</option>
                  </select>
                </div>
                <div class="clear"></div>
              </div>
            </li>
            <li class="R-variantswitcher">
              <div class="padding menu-control">
                <i class="fa-fw fas fa-paint-brush"></i>
                <span>&nbsp;</span>
                <div class="control-style">
                  <label class="a11y-only" for="R-select-variant">Theme</label>
                  <select id="R-select-variant">
                    <option id="R-select-variant-relearn-light" value="relearn-light" selected>Relearn Light</option>
                    <option id="R-select-variant-relearn-dark" value="relearn-dark">Relearn Dark</option>
                  </select>
                </div>
                <div class="clear"></div>
              </div>
              <script>window.relearn.markVariant();</script>
            </li>
          </ul>
        </div>
<div id="R-footer"><p>Built with <a href="https://github.com/McShelby/hugo-theme-relearn" title="love"><i class="fas fa-heart"></i></a> by <a href="https://gohugo.io/">Hugo</a></p></div>
      </div>
    </aside>
    <script src="/js/clipboard/clipboard.min.js?1758804677" defer></script>
    <script src="/js/perfect-scrollbar/perfect-scrollbar.min.js?1758804677" defer></script>
    <script src="/js/theme.js?1758804677" defer></script>
  </body>
</html>
